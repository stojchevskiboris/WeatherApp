<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather</title>
    <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
    <link rel="stylesheet" href="jquery/jquery-ui.css">
    <script src="jquery/jquery.js"></script>
    <script src="jquery/jquery-ui.js"></script>
    <link rel="stylesheet" href="Bootstrap/bootstrap.min.css"  integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="Bootstrap/bootstrap.bundle.min.js"  integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>


</head>
<body class="container">

<header class="navbar navbar-dark border-bottom mb-3">

    <img src="icons/weather.png" height="60" width="60" />
    <p class="nav nav-item">Weather App</p>
</header>

<div>
    <input onkeyup="inAuto()" class="form-control-lg border-primary btn-group" placeholder="Search City, Country" type="text" id="cityInput">
    <button class="btn btn-lg btn-outline-primary" id="add">Search</button>
</div>



<div class="row">

    <div class="col" id="p"></div>
</div>
</body>

<script>



    $(document).ready(function () {
        $("#add").click(async function () {
            let city = $("#cityInput").val()
            console.log(city)

            // http://api.weatherapi.com/v1/forecast.json?key=19a1d968ac214ba2b3d195557233001&q=Resen Mkd&days=10&aqi=yes&alerts=no

            let url = 'http://api.weatherapi.com/v1/forecast.json?key=19a1d968ac214ba2b3d195557233001&q=' + city + '&days=9&aqi=yes&alerts=no'

            let request = new Request(url, {
                method: 'GET'
            });
            let result = await fetch(request);
            let response = await result.json();
            console.log(response)


            document.getElementById("p").innerText = JSON.stringify(response)


        })



        let input = document.getElementById("cityInput");
        input.addEventListener("keypress", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                document.getElementById("add").click();
            }
        });
    })
    async function inAuto() {
        let cities = [];
        let q = $("#cityInput").val()
        if (q=="") return;

        let url = 'http://api.weatherapi.com/v1/search.json?key=19a1d968ac214ba2b3d195557233001&q=' + q

        let request = new Request(url, {
            method: 'GET'
        });
        let result = await fetch(request);
        let response = await result.json();
        var j = response.length;
        for(i=0;i<j;i++){
            cities.push(response[i].name + ", " + response[i].country)
        }

        $("#cityInput").autocomplete({
            source: cities
        })

    }
</script>

<style>
    body{
        margin: 2px;
    }
    .row {
        --bs-gutter-x: 0;
        --bs-gutter-y: 0;
    }



</style>

</html>